import o from"node:path";import{fileURLToPath as s}from"node:url";import{app as l,BrowserWindow as r,session as p,ipcMain as c}from"electron";var d=o.dirname(s(import.meta.url));console.log("Preload path:",o.join(d,"../electron/preload.cjs"));function f(){let n=new r({width:440,height:680,show:!1,icon:o.join(d,"../assets/icon.ico"),autoHideMenuBar:!0,webPreferences:{preload:o.join(d,"preload.cjs"),sandbox:!1,webSecurity:!1}});n.once("ready-to-show",()=>{n.show()}),n.loadFile(o.join(d,"../renderer/dist/index.html")),c.on("electron-download",(t,e)=>{n.webContents.downloadURL(e)}),p.defaultSession.on("will-download",(t,e,a)=>{e.setSaveDialogOptions({title:"Save PDF",defaultPath:"EF - Coupons.pdf",filters:[{name:"PDF File",extensions:["pdf"]}]}),e.on("updated",()=>{a.send("download-started","EF - Coupons.pdf")}),e.once("done",(w,i)=>{i==="completed"?a.send("download-complete","EF - Coupons.pdf"):a.send("download-failed","EF - Coupons.pdf")})})}l.whenReady().then(f);
